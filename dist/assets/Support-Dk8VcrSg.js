import{r as t,a as r,u as a,j as e,I as m,f as l,P as M,L as i,C as D,b as L,c as P,d as U,e as E,h as fe}from"./index-DqxcJu2F.js";import{D as O,e as q,a as H,b as R,c as F,f as _}from"./dialog-CjVt5OCo.js";import{S as A}from"./StatusBadge-CJzfnt7s.js";import{T as ve,a as Ne,b as B,c as I}from"./tabs-3hGs6Jtc.js";import{T as G}from"./textarea-BtgywGZe.js";import{S as be,a as ye,b as Ce,c as we,d as b}from"./select-DioDUAlB.js";import{B as Se,G as Te,M as ke}from"./message-square-DTZl1Rvo.js";import{S as V}from"./search-Kqcw5TmY.js";import{P as Q}from"./pen-square-BpQFywdQ.js";import{T as W}from"./trash-2-DELfmlqf.js";function Ie(){const[j,Y]=t.useState("help"),[J,K]=t.useState([]),[X,Z]=t.useState([]),[ee,se]=t.useState([]),[De,$]=t.useState(!0),[o,y]=t.useState(""),[te,f]=t.useState(!1),[C,w]=t.useState(null),[c,h]=t.useState({title:"",content:"",category:"",isPublished:!0}),[ae,v]=t.useState(!1),[S,T]=t.useState(null),[n,x]=t.useState({title:"",description:"",youtubeLink:"",steps:[],isPublished:!0}),[le,N]=t.useState(!1),[u,re]=t.useState(null),[k,z]=t.useState("");t.useEffect(()=>{p()},[j]);const p=async()=>{$(!0);try{if(j==="help"){const s=await r.get("/super-admin/support/help-articles");K(s.data.articles||[])}else if(j==="tutorials"){const s=await r.get("/super-admin/support/tutorials");Z(s.data.tutorials||[])}else if(j==="tickets"){const s=await r.get("/super-admin/support/tickets");se(s.data.tickets||[])}}catch{a.error("Failed to fetch data")}finally{$(!1)}},ie=async()=>{try{C?(await r.put(`/super-admin/support/help-articles/${C._id}`,c),a.success("Help article updated")):(await r.post("/super-admin/support/help-articles",c),a.success("Help article created")),f(!1),w(null),h({title:"",content:"",category:"",isPublished:!0}),p()}catch{a.error("Failed to save help article")}},ce=async s=>{if(confirm("Delete this help article?"))try{await r.delete(`/super-admin/support/help-articles/${s}`),a.success("Help article deleted"),p()}catch{a.error("Failed to delete")}},ne=async()=>{try{S?(await r.put(`/super-admin/support/tutorials/${S._id}`,n),a.success("Tutorial updated")):(await r.post("/super-admin/support/tutorials",n),a.success("Tutorial created")),v(!1),T(null),x({title:"",description:"",youtubeLink:"",steps:[],isPublished:!0}),p()}catch{a.error("Failed to save tutorial")}},de=async s=>{if(confirm("Delete this tutorial?"))try{await r.delete(`/super-admin/support/tutorials/${s}`),a.success("Tutorial deleted"),p()}catch{a.error("Failed to delete")}},oe=async()=>{if(k.trim())try{await r.post(`/super-admin/support/tickets/${u._id}/reply`,{message:k}),a.success("Reply sent"),z(""),N(!1),p()}catch{a.error("Failed to send reply")}},ue=async(s,d)=>{try{await r.patch(`/super-admin/support/tickets/${s}/status`,{status:d}),a.success("Ticket status updated"),p()}catch{a.error("Failed to update status")}},he=s=>e.jsx(A,{status:s,positive:s==="RESOLVED",negative:s==="CLOSED"}),xe=s=>{const d={HIGH:"bg-amber-100 text-amber-800 border-amber-200",MEDIUM:"bg-sky-100 text-sky-800 border-sky-200",LOW:"bg-muted text-muted-foreground border-border",URGENT:"bg-red-50 text-red-700 border-red-200"};return e.jsx("span",{className:fe("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-medium",d[s]||"bg-muted"),children:s})},pe=J.filter(s=>s.title.toLowerCase().includes(o.toLowerCase())||s.content.toLowerCase().includes(o.toLowerCase())),me=X.filter(s=>s.title.toLowerCase().includes(o.toLowerCase())||s.description.toLowerCase().includes(o.toLowerCase())),je=ee.filter(s=>s.subject.toLowerCase().includes(o.toLowerCase())||s.description.toLowerCase().includes(o.toLowerCase()));return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Support Center"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage help articles, tutorials, and support tickets"})]})}),e.jsxs(ve,{value:j,onValueChange:Y,children:[e.jsxs(Ne,{children:[e.jsxs(B,{value:"help",children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"Help Articles"]}),e.jsxs(B,{value:"tutorials",children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Tutorials"]}),e.jsxs(B,{value:"tickets",children:[e.jsx(ke,{className:"h-4 w-4 mr-2"}),"Support Tickets"]})]}),e.jsxs(I,{value:"help",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(V,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(m,{placeholder:"Search help articles...",value:o,onChange:s=>y(s.target.value),className:"pl-10"})]}),e.jsxs(O,{open:te,onOpenChange:f,children:[e.jsx(q,{asChild:!0,children:e.jsxs(l,{onClick:()=>{w(null),h({title:"",content:"",category:"",isPublished:!0})},children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"New Article"]})}),e.jsxs(H,{className:"max-w-2xl",children:[e.jsx(R,{children:e.jsxs(F,{children:[C?"Edit":"Create"," Help Article"]})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Title"}),e.jsx(m,{value:c.title,onChange:s=>h({...c,title:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Category"}),e.jsx(m,{value:c.category,onChange:s=>h({...c,category:s.target.value}),placeholder:"e.g., Getting Started, Billing, etc."})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Content"}),e.jsx(G,{value:c.content,onChange:s=>h({...c,content:s.target.value}),rows:10})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"helpPublished",checked:c.isPublished,onChange:s=>h({...c,isPublished:s.target.checked})}),e.jsx(i,{htmlFor:"helpPublished",children:"Published"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{variant:"outline",onClick:()=>f(!1),children:"Cancel"}),e.jsx(l,{onClick:ie,children:"Save"})]})]})})]})]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:pe.map(s=>e.jsxs(D,{children:[e.jsxs(L,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(P,{className:"text-lg",children:s.title}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>{w(s),h(s),f(!0)},children:e.jsx(Q,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>ce(s._id),children:e.jsx(W,{className:"h-4 w-4"})})]})]}),e.jsx(U,{children:s.category})]}),e.jsxs(E,{children:[e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-3",children:s.content}),e.jsx(A,{status:s.isPublished?"Published":"Draft",positive:s.isPublished,className:"mt-2"})]})]},s._id))})]}),e.jsxs(I,{value:"tutorials",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(V,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(m,{placeholder:"Search tutorials...",value:o,onChange:s=>y(s.target.value),className:"pl-10"})]}),e.jsxs(O,{open:ae,onOpenChange:v,children:[e.jsx(q,{asChild:!0,children:e.jsxs(l,{onClick:()=>{T(null),x({title:"",description:"",youtubeLink:"",steps:[],isPublished:!0})},children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"New Tutorial"]})}),e.jsxs(H,{className:"max-w-2xl",children:[e.jsx(R,{children:e.jsxs(F,{children:[S?"Edit":"Create"," Tutorial"]})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Title"}),e.jsx(m,{value:n.title,onChange:s=>x({...n,title:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Description"}),e.jsx(G,{value:n.description,onChange:s=>x({...n,description:s.target.value}),rows:3})]}),e.jsxs("div",{children:[e.jsx(i,{children:"YouTube Link"}),e.jsx(m,{value:n.youtubeLink,onChange:s=>x({...n,youtubeLink:s.target.value}),placeholder:"https://www.youtube.com/watch?v=..."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"tutorialPublished",checked:n.isPublished,onChange:s=>x({...n,isPublished:s.target.checked})}),e.jsx(i,{htmlFor:"tutorialPublished",children:"Published"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{variant:"outline",onClick:()=>v(!1),children:"Cancel"}),e.jsx(l,{onClick:ne,children:"Save"})]})]})})]})]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:me.map(s=>e.jsxs(D,{children:[e.jsx(L,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(P,{className:"text-lg",children:s.title}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>{T(s),x(s),v(!0)},children:e.jsx(Q,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>de(s._id),children:e.jsx(W,{className:"h-4 w-4"})})]})]})}),e.jsxs(E,{children:[e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-3",children:s.description}),s.youtubeLink&&e.jsx("div",{className:"mt-2",children:e.jsx("a",{href:s.youtubeLink,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline",children:"Watch Video →"})}),e.jsx(A,{status:s.isPublished?"Published":"Draft",positive:s.isPublished,className:"mt-2"})]})]},s._id))})]}),e.jsxs(I,{value:"tickets",className:"space-y-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(V,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(m,{placeholder:"Search tickets...",value:o,onChange:s=>y(s.target.value),className:"pl-10"})]}),e.jsx("div",{className:"space-y-4",children:je.map(s=>{var d;return e.jsxs(D,{children:[e.jsx(L,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[e.jsx(P,{className:"text-base sm:text-lg break-words",children:s.subject}),he(s.status),xe(s.priority)]}),e.jsxs(U,{className:"text-xs sm:text-sm",children:["From: ",((d=s.businessId)==null?void 0:d.businessName)||"Unknown Business"," • ",new Date(s.createdAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 shrink-0",children:[e.jsxs(be,{value:s.status,onValueChange:g=>ue(s._id,g),children:[e.jsx(ye,{className:"w-full sm:w-32",children:e.jsx(Ce,{})}),e.jsxs(we,{children:[e.jsx(b,{value:"OPEN",children:"OPEN"}),e.jsx(b,{value:"IN_PROGRESS",children:"IN_PROGRESS"}),e.jsx(b,{value:"RESOLVED",children:"RESOLVED"}),e.jsx(b,{value:"CLOSED",children:"CLOSED"})]})]}),e.jsx(l,{variant:"outline",size:"sm",className:"w-full sm:w-auto",onClick:()=>{re(s),N(!0)},children:"Reply"})]})]})}),e.jsxs(E,{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description}),s.replies&&s.replies.length>0&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("p",{className:"text-sm font-medium",children:["Replies (",s.replies.length,")"]}),s.replies.map((g,ge)=>e.jsxs("div",{className:"bg-muted/80 p-3 rounded-lg",children:[e.jsx("p",{className:"text-sm",children:g.message}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:new Date(g.repliedAt).toLocaleString()})]},ge))]})]})]},s._id)})}),e.jsx(O,{open:le,onOpenChange:N,children:e.jsxs(H,{className:"max-w-2xl",children:[e.jsx(R,{children:e.jsx(F,{children:u==null?void 0:u.subject})}),e.jsx(_,{children:u&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Description"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:u.description})]}),u.replies&&u.replies.length>0&&e.jsxs("div",{children:[e.jsx(i,{children:"Replies"}),e.jsx("div",{className:"space-y-2 mt-2",children:u.replies.map((s,d)=>e.jsxs("div",{className:"bg-muted/80 p-3 rounded-lg",children:[e.jsx("p",{className:"text-sm",children:s.message}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:new Date(s.repliedAt).toLocaleString()})]},d))})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Your Reply"}),e.jsx(G,{value:k,onChange:s=>z(s.target.value),rows:4,placeholder:"Type your reply here..."})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(l,{variant:"outline",onClick:()=>N(!1),children:"Cancel"}),e.jsx(l,{onClick:oe,children:"Send Reply"})]})]})})]})})]})]})]})}export{Ie as default};
