import{i as b,r as i,a as x,u as v,j as e,V as J,k as o,f as d,P as N,F as H,l as q,U,W as Y,C as h,b as u,c as j,d as p,e as y,T as K}from"./index-3RdFwQhj.js";import{M as c,C as V,L as W,a as I}from"./LineChart-Cb3ZJ11k.js";import{u as O}from"./usePortalPath-CKaWAX-Z.js";import{f as g}from"./currencyUtils-CJd_f-r_.js";import{C as X}from"./clock-DbGwbc-N.js";import{R as k,B as G,C,X as w,Y as E,T,a as Q}from"./BarChart-Cb1etKHQ.js";import{M as _}from"./medal-cSZUP5k2.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=b("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=b("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=b("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),l={bar:"#FF7A45",grid:"#E8ECF4"};function oe(){const n=O(),[a,R]=i.useState(null),[D,L]=i.useState([]),[M,z]=i.useState([]),[f,F]=i.useState([]),[m,P]=i.useState("USD"),[A,B]=i.useState(!0);i.useEffect(()=>{$()},[]),i.useEffect(()=>{a!=null&&a.isEmployee&&x.get("/admin/leaderboard").then(s=>{var t;(t=s.data)!=null&&t.success&&s.data.leaderboard&&F(s.data.leaderboard.slice(0,5))}).catch(()=>{})},[a==null?void 0:a.isEmployee]),i.useEffect(()=>{x.get("/admin/settings").then(s=>{var t,r;(t=s.data)!=null&&t.success&&((r=s.data.settings)!=null&&r.currency)&&P(s.data.settings.currency)}).catch(()=>{})},[]);const $=async()=>{var s,t;try{const r=await x.get("/admin/dashboard");r.data.success?(R({...r.data.stats,isEmployee:!!r.data.isEmployee}),L(r.data.jobsTrend||[]),z(r.data.revenueTrend||[])):v.error("Failed to fetch dashboard data")}catch(r){v.error(((t=(s=r.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to fetch dashboard data")}finally{B(!1)}};return A||!a?e.jsx("div",{className:"flex justify-center items-center w-full",children:e.jsx(J,{size:"section"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-2xl font-semibold tracking-tight text-foreground",children:a.isEmployee?"Your performance":"Dashboard"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:a.isEmployee?"Your job stats, completion time and trends.":"Welcome back! Here's what's happening today."})]}),e.jsx(o,{to:`${n}/jobs/new`,className:"flex items-center",children:e.jsxs(d,{size:"default",className:"gap-2 w-full sm:w-auto",children:[e.jsx(N,{className:"h-4 w-4"}),"New Job"]})})]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsx(c,{title:"Today's Jobs",value:a.todayJobs,subtitle:"Total jobs today",icon:H,iconBg:"orange",valueClassName:"text-primary"}),e.jsx(c,{title:"In Progress",value:a.inProgress,subtitle:"Cars being serviced",icon:q,iconBg:"blue"}),e.jsx(c,{title:"Avg Completion",value:`${a.avgCompletionTime} min`,subtitle:"Average time",icon:X,iconBg:"purple"}),!a.isEmployee&&e.jsxs(e.Fragment,{children:[e.jsx(c,{title:"Today's Revenue",value:g(a.todayRevenue,m),subtitle:"Revenue today",icon:S,iconBg:"orange",valueClassName:"text-primary"}),e.jsx(c,{title:"Monthly Revenue",value:g(a.monthlyRevenue,m),subtitle:"This month",icon:S,iconBg:"blue"})]}),e.jsx(c,{title:"Pending Deliveries",value:a.pendingDeliveries,subtitle:"Awaiting pickup",icon:U,iconBg:"red"})]}),!a.isEmployee&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"text-lg font-medium text-foreground",children:"Quick Actions"}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(o,{to:`${n}/jobs/new`,children:e.jsxs(d,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(N,{className:"h-4 w-4"}),"New Job"]})}),e.jsx(o,{to:`${n}/jobs`,children:e.jsxs(d,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(Z,{className:"h-4 w-4"}),"View All Jobs"]})}),e.jsx(o,{to:`${n}/customers`,children:e.jsxs(d,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"Customers"]})}),e.jsx(o,{to:`${n}/services`,children:e.jsxs(d,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(Y,{className:"h-4 w-4"}),"Services"]})}),e.jsx(o,{to:`${n}/my-plan`,children:e.jsxs(d,{variant:"outline",size:"sm",className:"gap-2",children:[e.jsx(V,{className:"h-4 w-4"}),"My Plan"]})})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(h,{children:[e.jsxs(u,{children:[e.jsx(j,{children:a.isEmployee?"Your jobs (last 7 days)":"Jobs (last 7 days)"}),e.jsx(p,{children:"Number of jobs per day"})]}),e.jsx(y,{children:e.jsx(k,{width:"100%",height:260,children:e.jsxs(G,{data:D,children:[e.jsx(C,{strokeDasharray:"3 3",stroke:l.grid}),e.jsx(w,{dataKey:"date",tick:{fontSize:12},stroke:l.grid}),e.jsx(E,{allowDecimals:!1,stroke:l.grid}),e.jsx(T,{contentStyle:{borderRadius:12,border:"1px solid #E8ECF4"}}),e.jsx(Q,{dataKey:"jobs",fill:l.bar,radius:[6,6,0,0]})]})})})]}),a.isEmployee?e.jsxs(h,{children:[e.jsxs(u,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsxs("div",{children:[e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-amber-500"}),"Leaderboard"]}),e.jsx(p,{children:"Top performers by completed jobs"})]}),e.jsx(o,{to:`${n}/leaderboard`,children:e.jsx(d,{variant:"ghost",size:"sm",children:"View all"})})]}),e.jsx(y,{children:f.length===0?e.jsx("p",{className:"text-sm text-muted-foreground py-6 text-center",children:"No data yet."}):e.jsx("div",{className:"space-y-2",children:f.map((s,t)=>e.jsxs("div",{className:`flex items-center justify-between gap-2 py-2 px-3 rounded-lg ${t===0?"bg-amber-50 border border-amber-100":t===1?"bg-slate-50 border border-slate-100":t===2?"bg-orange-50/50 border border-orange-100":"bg-muted/30"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("span",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-primary/10 text-primary text-sm font-bold",children:t===0?e.jsx(_,{className:"h-4 w-4"}):t+1}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"font-medium text-sm truncate",children:s.name}),e.jsx("div",{className:"text-xs text-muted-foreground font-mono",children:s.employeeCode})]})]}),e.jsxs("div",{className:"flex items-center gap-3 shrink-0 text-sm",children:[e.jsx("span",{className:"font-semibold",children:s.completedCount}),e.jsx("span",{className:"text-muted-foreground",children:"completed"}),e.jsxs("span",{className:"font-semibold",children:[s.avgCompletionMinutes,"m"]})]})]},s.userId))})})]}):e.jsxs(h,{children:[e.jsxs(u,{children:[e.jsx(j,{children:"Revenue (last 7 days)"}),e.jsx(p,{children:"Daily revenue"})]}),e.jsx(y,{children:e.jsx(k,{width:"100%",height:260,children:e.jsxs(W,{data:M,children:[e.jsx(C,{strokeDasharray:"3 3",stroke:l.grid}),e.jsx(w,{dataKey:"date",tick:{fontSize:12},stroke:l.grid}),e.jsx(E,{tickFormatter:s=>s>=1e3?`${s/1e3}k`:s,stroke:l.grid}),e.jsx(T,{formatter:s=>[g(s,m),"Revenue"],contentStyle:{borderRadius:12,border:"1px solid #E8ECF4"}}),e.jsx(I,{type:"monotone",dataKey:"revenue",stroke:l.bar,strokeWidth:2,dot:{r:4}})]})})})]})]})]})}export{oe as default};
