import{r as p,j as e,V as S,C as v,b as y,c as C,d as N,e as w,L as i,I as l,f as z,a as k,u}from"./index-3RdFwQhj.js";import{N as J}from"./number-input-FVaYIwHX.js";import{T as _}from"./textarea-fTS06cJM.js";import{S as I,a as D,b as q,c as M,d as j}from"./select-CUIkZR0j.js";import{T as Y,a as K,b as B,c as U}from"./tabs-B0BN5O9m.js";function ee(){var A,E,F,T,W,L;const[r,t]=p.useState({businessName:"",ownerName:"",email:"",phone:"",whatsappNumber:"",address:"",location:"",workingHoursStart:"09:00",workingHoursEnd:"18:00",carHandlingCapacity:"SINGLE",maxConcurrentJobs:1}),[a,o]=p.useState({capacity:5,currency:"USD",timezone:"UTC",autoSendWhatsApp:!0,workingHours:{start:"09:00",end:"18:00"},notificationPreferences:{jobCreated:!0,jobCompleted:!0,jobDelivered:!0,planExpiry:!0}}),[f,b]=p.useState(!1),[V,H]=p.useState(!0),P=async()=>{var s,h,m,x;try{const[d,c]=await Promise.allSettled([k.get("/admin/business"),k.get("/admin/settings")]);if(d.status==="fulfilled"&&((h=(s=d.value)==null?void 0:s.data)!=null&&h.success)&&d.value.data.business){const n=d.value.data.business;t({businessName:n.businessName||"",ownerName:n.ownerName||"",email:n.email||"",phone:n.phone||"",whatsappNumber:n.whatsappNumber||"",address:n.address||"",location:n.location||"",workingHoursStart:n.workingHoursStart||"09:00",workingHoursEnd:n.workingHoursEnd||"18:00",carHandlingCapacity:n.carHandlingCapacity||"SINGLE",maxConcurrentJobs:n.maxConcurrentJobs??1})}if(c.status==="fulfilled"&&((x=(m=c.value)==null?void 0:m.data)!=null&&x.success)&&c.value.data.settings){const n=c.value.data.settings;o(g=>({...g,capacity:n.capacity??g.capacity,currency:n.currency??g.currency,timezone:n.timezone??g.timezone,autoSendWhatsApp:n.autoSendWhatsApp!==void 0?n.autoSendWhatsApp:g.autoSendWhatsApp,workingHours:n.workingHours?{start:n.workingHours.start||"09:00",end:n.workingHours.end||"18:00"}:g.workingHours,notificationPreferences:n.notificationPreferences?{...g.notificationPreferences,...n.notificationPreferences}:g.notificationPreferences}))}c.status==="rejected"&&u.error("Failed to load settings")}catch{u.error("Failed to load page")}finally{H(!1)}};p.useEffect(()=>(H(!0),P().then(()=>{}),()=>{}),[]);const G=async()=>{var h,m;const s=Number(r.maxConcurrentJobs);if(r.carHandlingCapacity==="MULTIPLE"&&(!s||s===0)){u.error("Max concurrent jobs must be greater than zero");return}b(!0);try{await k.put("/admin/business",{...r,maxConcurrentJobs:s||1}),u.success("Business information updated successfully"),P()}catch(x){u.error(((m=(h=x.response)==null?void 0:h.data)==null?void 0:m.message)||"Failed to update business information")}finally{b(!1)}},R=async()=>{var h,m;const s=Number(a.capacity);if(!s||s===0){u.error("Daily capacity must be greater than zero");return}b(!0);try{const x={capacity:s,timezone:a.timezone,autoSendWhatsApp:a.autoSendWhatsApp,workingHours:a.workingHours||{start:"09:00",end:"18:00"},notificationPreferences:a.notificationPreferences},d=await k.put("/admin/settings",x);if(d.data.success){if(u.success("Settings saved successfully"),d.data.settings){const c=d.data.settings;o(n=>({...n,...c,workingHours:c.workingHours?{...n.workingHours,...c.workingHours}:n.workingHours,notificationPreferences:c.notificationPreferences?{...n.notificationPreferences,...c.notificationPreferences}:n.notificationPreferences}))}}else u.error("Failed to save settings")}catch(x){u.error(((m=(h=x.response)==null?void 0:h.data)==null?void 0:m.message)||"Failed to save settings")}finally{b(!1)}};return V?e.jsx("div",{className:"flex justify-center items-center w-full",children:e.jsx(S,{size:"section"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold tracking-tight text-slate-800",children:"Settings"}),e.jsx("p",{className:"text-muted-foreground text-sm mt-0.5",children:"Manage your business information and preferences"})]}),e.jsxs(Y,{defaultValue:"business",className:"space-y-4",children:[e.jsxs(K,{className:"flex flex-wrap gap-1",children:[e.jsx(B,{value:"business",children:"Business Information"}),e.jsx(B,{value:"settings",children:"Settings & Preferences"})]}),e.jsx(U,{value:"business",className:"space-y-4",children:e.jsxs(v,{children:[e.jsxs(y,{children:[e.jsx(C,{children:"Business Information"}),e.jsx(N,{children:"Update your business details. You can edit this information anytime."})]}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"businessName",children:"Business Name *"}),e.jsx(l,{id:"businessName",value:r.businessName,onChange:s=>t({...r,businessName:s.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"ownerName",children:"Owner Name *"}),e.jsx(l,{id:"ownerName",value:r.ownerName,onChange:s=>t({...r,ownerName:s.target.value}),required:!0})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"email",children:"Business Email *"}),e.jsx(l,{id:"email",type:"email",value:r.email,onChange:s=>t({...r,email:s.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"address",children:"Address *"}),e.jsx(_,{id:"address",value:r.address,onChange:s=>t({...r,address:s.target.value}),rows:3,required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"location",children:"Location"}),e.jsx(l,{id:"location",value:r.location,onChange:s=>t({...r,location:s.target.value}),placeholder:"City, State, Country"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"phone",children:"Phone *"}),e.jsx(l,{id:"phone",value:r.phone,onChange:s=>t({...r,phone:s.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"whatsappNumber",children:"WhatsApp Number *"}),e.jsx(l,{id:"whatsappNumber",value:r.whatsappNumber,onChange:s=>t({...r,whatsappNumber:s.target.value}),placeholder:"+1234567890",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"workingHoursStart",children:"Working Hours Start *"}),e.jsx(l,{id:"workingHoursStart",type:"time",value:r.workingHoursStart,onChange:s=>t({...r,workingHoursStart:s.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"workingHoursEnd",children:"Working Hours End *"}),e.jsx(l,{id:"workingHoursEnd",type:"time",value:r.workingHoursEnd,onChange:s=>t({...r,workingHoursEnd:s.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"carHandlingCapacity",children:"Car Handling Capacity *"}),e.jsxs(I,{value:r.carHandlingCapacity,onValueChange:s=>t({...r,carHandlingCapacity:s,maxConcurrentJobs:s==="SINGLE"?1:r.maxConcurrentJobs}),children:[e.jsx(D,{children:e.jsx(q,{})}),e.jsxs(M,{children:[e.jsx(j,{value:"SINGLE",children:"Single Car"}),e.jsx(j,{value:"MULTIPLE",children:"Multiple Cars"})]})]})]}),r.carHandlingCapacity==="MULTIPLE"&&e.jsxs("div",{children:[e.jsx(i,{htmlFor:"maxConcurrentJobs",children:"Max Concurrent Jobs *"}),e.jsx(J,{id:"maxConcurrentJobs",value:r.maxConcurrentJobs??1,onChange:s=>t({...r,maxConcurrentJobs:s}),required:!0})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-border",children:e.jsx(z,{onClick:G,disabled:f,className:"min-h-[44px]",children:f?e.jsxs(e.Fragment,{children:[e.jsx(S,{size:"inline",className:"mr-2"})," Saving..."]}):"Save Business Information"})})]})]})}),e.jsxs(U,{value:"settings",className:"space-y-4",children:[e.jsxs(v,{children:[e.jsxs(y,{children:[e.jsx(C,{children:"Operational Settings"}),e.jsx(N,{children:"Configure your business operations"})]}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"settingsWorkingHoursStart",children:"Working Hours Start"}),e.jsx(l,{id:"settingsWorkingHoursStart",type:"time",value:((A=a.workingHours)==null?void 0:A.start)||"09:00",onChange:s=>o({...a,workingHours:{...a.workingHours,start:s.target.value}})})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"settingsWorkingHoursEnd",children:"Working Hours End"}),e.jsx(l,{id:"settingsWorkingHoursEnd",type:"time",value:((E=a.workingHours)==null?void 0:E.end)||"18:00",onChange:s=>o({...a,workingHours:{...a.workingHours,end:s.target.value}})})]})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"capacity",children:"Daily Capacity"}),e.jsx(J,{id:"capacity",value:a.capacity??5,onChange:s=>o({...a,capacity:s})}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Maximum number of jobs per day"})]})]})]}),e.jsxs(v,{children:[e.jsxs(y,{children:[e.jsx(C,{children:"General Settings"}),e.jsx(N,{children:"Timezone preferences. Currency is set in Super Admin Settings and applies across the platform."})]}),e.jsx(w,{className:"space-y-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx(i,{htmlFor:"timezone",children:"Timezone"}),e.jsxs(I,{value:a.timezone,onValueChange:s=>o({...a,timezone:s}),children:[e.jsx(D,{children:e.jsx(q,{})}),e.jsxs(M,{children:[e.jsx(j,{value:"UTC",children:"UTC"}),e.jsx(j,{value:"America/New_York",children:"EST (America/New_York)"}),e.jsx(j,{value:"America/Chicago",children:"CST (America/Chicago)"}),e.jsx(j,{value:"America/Denver",children:"MST (America/Denver)"}),e.jsx(j,{value:"America/Los_Angeles",children:"PST (America/Los_Angeles)"}),e.jsx(j,{value:"Asia/Kolkata",children:"IST (Asia/Kolkata)"})]})]})]})})})]}),e.jsxs(v,{children:[e.jsxs(y,{children:[e.jsx(C,{children:"Notification Preferences"}),e.jsx(N,{children:"Control when you receive notifications"})]}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Auto-send WhatsApp Messages"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically send WhatsApp notifications for job updates"})]}),e.jsx("input",{type:"checkbox",checked:a.autoSendWhatsApp,onChange:s=>o({...a,autoSendWhatsApp:s.target.checked}),className:"h-4 w-4"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Job Created"}),e.jsx("input",{type:"checkbox",checked:((F=a.notificationPreferences)==null?void 0:F.jobCreated)||!1,onChange:s=>o({...a,notificationPreferences:{...a.notificationPreferences,jobCreated:s.target.checked}}),className:"h-4 w-4"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Job Completed"}),e.jsx("input",{type:"checkbox",checked:((T=a.notificationPreferences)==null?void 0:T.jobCompleted)||!1,onChange:s=>o({...a,notificationPreferences:{...a.notificationPreferences,jobCompleted:s.target.checked}}),className:"h-4 w-4"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Job Delivered"}),e.jsx("input",{type:"checkbox",checked:((W=a.notificationPreferences)==null?void 0:W.jobDelivered)||!1,onChange:s=>o({...a,notificationPreferences:{...a.notificationPreferences,jobDelivered:s.target.checked}}),className:"h-4 w-4"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Plan Expiry Reminders"}),e.jsx("input",{type:"checkbox",checked:((L=a.notificationPreferences)==null?void 0:L.planExpiry)||!1,onChange:s=>o({...a,notificationPreferences:{...a.notificationPreferences,planExpiry:s.target.checked}}),className:"h-4 w-4"})]})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(z,{onClick:R,disabled:f,size:"lg",className:"min-h-[44px]",children:f?e.jsxs(e.Fragment,{children:[e.jsx(S,{size:"inline",className:"mr-2"})," Saving..."]}):"Save Settings"})})]})]})]})}export{ee as default};
