import{r as n,a as d,u as l,j as e,V as p,M as B,C as g,b as x,c as f,d as j,e as b,p as E,L as N,I as F,f as m}from"./index-D5eo3nMI.js";import{T as H}from"./textarea-Ci_GesZ1.js";const c={received:"Hello {{name}}, your vehicle {{vehicleNumber}} has been received. Token: {{token}}",workStarted:"Your car {{vehicleNumber}} â€“ work is in progress.",completed:"âœ… Your vehicle {{vehicleNumber}} is ready for delivery. Token: {{token}}",delivered:`ðŸš— Thank you! Your vehicle {{vehicleNumber}} has been delivered. Job completed.

Before photos: {{beforeImagesLink}}
After photos: {{afterImagesLink}}`},h={received:"Received",workStarted:"Work Started (In Progress)",completed:"Completed (Ready to Delivery)",delivered:"Delivered (Job Completed)"},I="{{name}}, {{vehicleNumber}}, {{token}}. For Delivered: {{beforeImagesLink}}, {{afterImagesLink}}";function K(){const[G,M]=n.useState(!0),[S,w]=n.useState(!1),[y,L]=n.useState(!1),[k,T]=n.useState(!1),[R,A]=n.useState(""),[C,W]=n.useState(""),[D,u]=n.useState({...c});n.useEffect(()=>{P()},[]);const P=async()=>{var s,t;try{const a=await d.get("/admin/settings");if(a.data.success&&a.data.settings){const r=a.data.settings;A(r.shopWhatsappNumber||""),W(r.googleReviewLink||"");const i=r.whatsappTemplates||{};u(Object.keys(h).reduce((o,v)=>(o[v]=i[v]??c[v]??"",o),{}))}}catch(a){l.error(((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to load settings")}finally{M(!1)}},U=async s=>{var a,r;s==null||s.preventDefault();const t=(R||"").trim();if(!t){l.error("Shop WhatsApp number is required");return}w(!0);try{await d.put("/admin/settings",{shopWhatsappNumber:t}),l.success("Shop WhatsApp number saved")}catch(i){l.error(((r=(a=i.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to save")}finally{w(!1)}},Y=async s=>{var t,a;s==null||s.preventDefault(),L(!0);try{const r=Object.keys(h).reduce((i,o)=>(i[o]=D[o]??c[o]??"",i),{});await d.put("/admin/settings",{whatsappTemplates:r}),l.success("Templates saved")}catch(r){l.error(((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to save templates")}finally{L(!1)}},z=()=>{u({...c}),l.success("Templates reset to default. Click Save Templates to apply.")},O=async s=>{var t,a;s==null||s.preventDefault(),T(!0);try{await d.put("/admin/settings",{googleReviewLink:(C||"").trim()}),l.success("Google Review link saved")}catch(r){l.error(((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to save link")}finally{T(!1)}};return G?e.jsx("div",{className:"flex justify-center items-center w-full",children:e.jsx(p,{size:"section"})}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight flex items-center gap-2",children:[e.jsx(B,{className:"h-8 w-8 text-[#25D366]"}),"WhatsApp Settings"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Configure click-to-WhatsApp alerts for job status. No API or automation â€” you send messages manually from your number."})]}),e.jsxs(g,{children:[e.jsxs(x,{children:[e.jsx(f,{children:"Shop WhatsApp Number"}),e.jsx(j,{children:"Your shop WhatsApp number (with country code, e.g. 1234567890). Used for wa.me click-to-chat to the customer."})]}),e.jsx(b,{className:"space-y-4",children:e.jsxs("form",{onSubmit:U,onKeyDown:E,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(N,{htmlFor:"shopWhatsappNumber",children:"WhatsApp Number *"}),e.jsx(F,{id:"shopWhatsappNumber",type:"tel",placeholder:"e.g. 1234567890",value:R,onChange:s=>A(s.target.value),className:"mt-1"})]}),e.jsxs(m,{type:"submit",disabled:S,children:[S?e.jsx(p,{size:"inline",className:"mr-2"}):null,"Save"]})]})})]}),e.jsxs(g,{children:[e.jsxs(x,{children:[e.jsx(f,{children:"WhatsApp Message Templates"}),e.jsxs(j,{children:["Editable messages for each job status. Use placeholders: ",I,". You can copy the pre-filled message and send from WhatsApp."]})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Allowed placeholders: ",e.jsx("code",{className:"bg-muted px-1 rounded",children:I})]}),Object.keys(h).map(s=>e.jsxs("div",{children:[e.jsx(N,{htmlFor:`template-${s}`,children:h[s]}),e.jsx(H,{id:`template-${s}`,value:D[s]??"",onChange:t=>u(a=>({...a,[s]:t.target.value})),rows:3,className:"mt-1 font-mono text-sm",placeholder:c[s]})]},s)),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(m,{onClick:Y,disabled:y,children:[y?e.jsx(p,{size:"inline",className:"mr-2"}):null,"Save Templates"]}),e.jsx(m,{type:"button",variant:"outline",onClick:z,children:"Reset to Default"})]})]})]}),e.jsxs(g,{children:[e.jsxs(x,{children:[e.jsx(f,{children:"Google Review Link"}),e.jsx(j,{children:'URL for customers to leave a Google review. Shown in the "Ask for Google Review" WhatsApp message after delivery.'})]}),e.jsx(b,{className:"space-y-4",children:e.jsxs("form",{onSubmit:O,onKeyDown:E,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(N,{htmlFor:"googleReviewLink",children:"Google Review URL"}),e.jsx(F,{id:"googleReviewLink",type:"url",placeholder:"https://g.page/your-business/review",value:C,onChange:s=>W(s.target.value),className:"mt-1"})]}),e.jsxs(m,{type:"submit",disabled:k,children:[k?e.jsx(p,{size:"inline",className:"mr-2"}):null,"Save Link"]})]})})]})]})}export{K as default};
