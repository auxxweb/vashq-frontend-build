import{q as D,n as A,o as T,r as i,a as k,u as b,j as e,V as R,k as y,f as S,A as L,C as m,b as x,c as p,F as _,d as h,e as j,l as F}from"./index-DbUb8UN5.js";import{B as I}from"./badge-BYh-yafP.js";import{f as M}from"./currencyUtils-CJd_f-r_.js";import{T as P}from"./trending-up-CurXscew.js";import{R as B,B as H,C as J,X as O,Y as V,T as W,a as z}from"./BarChart-BWS41ksB.js";import{f as K}from"./format-B3XKS-z2.js";const o={bar:"#FF7A45",grid:"#E8ECF4"},$={RECEIVED:"bg-sky-50 text-sky-700",WORK_STARTED:"bg-amber-50 text-amber-700",COMPLETED:"bg-emerald-50 text-emerald-700",DELIVERED:"bg-slate-100 text-slate-700",CANCELLED:"bg-red-50 text-red-700"};function Z(){var g;const{id:c}=D(),d=A(),{user:t}=T(s=>s.auth),[l,N]=i.useState(null),[a,C]=i.useState(null),[f,v]=i.useState([]),[E,u]=i.useState(!0);i.useEffect(()=>{if((t==null?void 0:t.role)!=="CAR_WASH_ADMIN"){d("/admin",{replace:!0});return}c&&w()},[c,t==null?void 0:t.role,d]);const w=async()=>{var s,n;u(!0);try{const r=await k.get(`/admin/employees/${c}`);r.data.success?(N(r.data.employee),C(r.data.performance||null),v(r.data.recentJobs||[])):(b.error("Employee not found"),d("/admin/employees"))}catch(r){b.error(((n=(s=r.response)==null?void 0:s.data)==null?void 0:n.message)||"Failed to load employee"),d("/admin/employees")}finally{u(!1)}};return(t==null?void 0:t.role)!=="CAR_WASH_ADMIN"?null:E?e.jsx("div",{className:"flex justify-center items-center w-full",children:e.jsx(R,{size:"section"})}):l?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx(y,{to:"/admin/employees",className:"min-h-[44px] min-w-[44px] flex items-center justify-center",children:e.jsx(S,{variant:"ghost",size:"icon",children:e.jsx(L,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-semibold tracking-tight",children:["Employee: ",l.name||l.email]}),e.jsxs("p",{className:"text-muted-foreground text-sm",children:[l.employeeCode," • ",l.email]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(m,{children:[e.jsxs(x,{children:[e.jsxs(p,{className:"text-base flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4"}),"Work performance"]}),e.jsx(h,{children:"Completed jobs and time"})]}),e.jsx(j,{className:"space-y-3",children:a?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between py-1 border-b",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Delivered jobs"}),e.jsx("span",{className:"font-semibold",children:a.completedCount})]}),e.jsxs("div",{className:"flex justify-between py-1 border-b",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Avg completion"}),e.jsxs("span",{className:"font-semibold",children:[a.avgCompletionMinutes," min"]})]}),e.jsxs("div",{className:"flex justify-between py-1 border-b",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Today"}),e.jsxs("span",{className:"font-semibold",children:[a.todayJobs," jobs"]})]}),e.jsxs("div",{className:"flex justify-between py-1 border-b",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"This month"}),e.jsxs("span",{className:"font-semibold",children:[a.monthJobs," jobs"]})]}),e.jsxs("div",{className:"flex justify-between py-1 border-b",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"In progress"}),e.jsx("span",{className:"font-semibold",children:a.inProgress})]}),e.jsxs("div",{className:"flex justify-between py-1",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Pending delivery"}),e.jsx("span",{className:"font-semibold",children:a.pendingDeliveries})]})]}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No performance data yet."})})]}),((g=a==null?void 0:a.jobsTrend)==null?void 0:g.length)>0&&e.jsxs(m,{className:"md:col-span-2",children:[e.jsxs(x,{children:[e.jsxs(p,{className:"text-base flex items-center gap-2",children:[e.jsx(P,{className:"h-4 w-4"}),"Jobs (last 7 days)"]}),e.jsx(h,{children:"Daily job count"})]}),e.jsx(j,{children:e.jsx(B,{width:"100%",height:220,children:e.jsxs(H,{data:a.jobsTrend,children:[e.jsx(J,{strokeDasharray:"3 3",stroke:o.grid}),e.jsx(O,{dataKey:"date",tick:{fontSize:11},stroke:o.grid}),e.jsx(V,{allowDecimals:!1,stroke:o.grid}),e.jsx(W,{contentStyle:{borderRadius:8,border:"1px solid #E8ECF4"}}),e.jsx(z,{dataKey:"jobs",fill:o.bar,radius:[4,4,0,0]})]})})})]})]}),e.jsxs(m,{children:[e.jsxs(x,{children:[e.jsxs(p,{className:"text-base flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),"Recent jobs"]}),e.jsx(h,{children:"Latest jobs assigned to this employee"})]}),e.jsx(j,{children:f.length===0?e.jsx("p",{className:"text-muted-foreground text-sm py-4",children:"No jobs yet."}):e.jsx("div",{className:"space-y-2",children:f.map(s=>{var n,r;return e.jsxs(y,{to:`/admin/jobs/${s._id}`,className:"block p-3 border rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-medium",children:["Token: ",s.tokenNumber]}),e.jsx(I,{className:$[s.status]||"",children:s.status.replace("_"," ")})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:K(new Date(s.createdAt),"MMM d, yyyy HH:mm")})]}),e.jsxs("div",{className:"text-sm text-muted-foreground mt-1",children:[(n=s.customerId)==null?void 0:n.name," • ",(r=s.carId)==null?void 0:r.carNumber,s.totalPrice!=null&&` • ${M(Number(s.totalPrice),"USD")}`]})]},s._id)})})})]})]}):null}export{Z as default};
