import{i as D,r as l,a as p,u as n,j as e,V as P,C as N,b as E,c as A,d as k,f as i,E as S,e as b}from"./index-DbUb8UN5.js";import{S as v}from"./StatusBadge-ChIJ-bKC.js";import{D as I,a as z,b as F,c as U,f as V}from"./dialog-BiDWtJbd.js";import{f as u}from"./format-B3XKS-z2.js";import{C as q}from"./check-circle-Gf1hBHtl.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y=D("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function G(){const[m,C]=l.useState([]),[w,R]=l.useState(!0),[a,d]=l.useState(null);l.useEffect(()=>{o()},[]);const o=async()=>{var s,t;try{const r=await p.get("/super-admin/upgrade-requests");r.data.success&&C(r.data.requests||[])}catch(r){n.error(((t=(s=r.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to load requests")}finally{R(!1)}},h=async s=>{var t,r;try{const c=await p.patch(`/super-admin/upgrade-requests/${s}/approve`);c.data.success?(n.success("Upgrade approved. Shop subscription updated."),d(null),o()):n.error(c.data.message||"Failed to approve")}catch(c){n.error(((r=(t=c.response)==null?void 0:t.data)==null?void 0:r.message)||"Failed to approve")}},x=async s=>{var t,r;try{const c=await p.patch(`/super-admin/upgrade-requests/${s}/reject`);c.data.success?(n.success("Upgrade rejected"),d(null),o()):n.error(c.data.message||"Failed to reject")}catch(c){n.error(((r=(t=c.response)==null?void 0:t.data)==null?void 0:r.message)||"Failed to reject")}},j=s=>{var t,r;return((t=s.shopId)==null?void 0:t.businessName)||((r=s.shopId)==null?void 0:r.ownerName)||"Shop"},g=s=>{var t;return((t=s.currentPlanId)==null?void 0:t.name)||"—"},f=s=>{var t;return((t=s.requestedPlanId)==null?void 0:t.name)||"—"};return w?e.jsx("div",{className:"flex justify-center items-center w-full",children:e.jsx(P,{size:"section"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Upgrade Requests"}),e.jsx("p",{className:"text-muted-foreground",children:"Review and approve or reject plan upgrade requests from shops. No payment processing."})]}),e.jsx("div",{className:"space-y-4",children:m.map(s=>e.jsx(N,{children:e.jsx(E,{children:e.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(A,{className:"text-lg",children:j(s)}),e.jsxs(k,{children:[g(s)," → ",f(s)]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Requested ",s.createdAt?u(new Date(s.createdAt),"PPp"):"—"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{status:s.status,positive:s.status==="APPROVED",negative:s.status==="REJECTED"}),e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>d(s),"aria-label":"View details",children:e.jsx(S,{className:"h-4 w-4"})}),s.status==="PENDING"&&e.jsxs(e.Fragment,{children:[e.jsxs(i,{size:"sm",onClick:()=>h(s._id),className:"gap-1",children:[e.jsx(q,{className:"h-4 w-4"})," Approve"]}),e.jsxs(i,{size:"sm",variant:"destructive",onClick:()=>x(s._id),className:"gap-1",children:[e.jsx(y,{className:"h-4 w-4"})," Reject"]})]})]})]})})},s._id))}),m.length===0&&e.jsx(N,{children:e.jsx(b,{className:"p-12 text-center text-muted-foreground",children:"No upgrade requests yet. Shops will appear here when they request a plan upgrade."})}),e.jsx(I,{open:!!a,onOpenChange:s=>!s&&d(null),children:e.jsxs(z,{children:[e.jsx(F,{children:e.jsx(U,{children:"Upgrade request details"})}),e.jsx(V,{children:a&&e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Shop:"})," ",j(a)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Current plan:"})," ",g(a)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Requested plan:"})," ",f(a)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Request date:"})," ",a.createdAt?u(new Date(a.createdAt),"PPp"):"—"]}),a.actionedAt&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Actioned:"})," ",u(new Date(a.actionedAt),"PPp")]}),a.message&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Message:"})," ",a.message]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Status:"})," ",e.jsx(v,{status:a.status,positive:a.status==="APPROVED",negative:a.status==="REJECTED"})]}),a.status==="PENDING"&&e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsxs(i,{onClick:()=>h(a._id),className:"gap-1",children:[e.jsx(q,{className:"h-4 w-4"})," Approve"]}),e.jsxs(i,{variant:"destructive",onClick:()=>x(a._id),className:"gap-1",children:[e.jsx(y,{className:"h-4 w-4"})," Reject"]})]})]})})]})})]})}export{G as default};
